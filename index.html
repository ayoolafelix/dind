<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Font Identification Game</title>

  <!-- Tailwind CDN for quick styling -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Include fonts that the game references -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:wght@400&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@400&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@400&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400&display=swap" rel="stylesheet">

  <style>
    /* small helper to show disabled button cursor */
    button[disabled] { cursor: not-allowed; opacity: 0.95; }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center p-4">

  <div id="root" class="w-full max-w-4xl"></div>

  <!-- React & ReactDOM (UMD builds) -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <!-- Babel so we can write JSX in the browser (convenient for single-file demos) -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- App code (JSX) -->
  <script type="text/babel">
    const { useState, useEffect } = React;

    const fonts = [
      { name: 'Helvetica', css: 'Helvetica, Arial, sans-serif', cdn: null },
      { name: 'Arial', css: 'Arial, sans-serif', cdn: null },
      { name: 'Times New Roman', css: '"Times New Roman", Times, serif', cdn: null },
      { name: 'Roboto', css: '"Roboto", sans-serif', cdn: 'https://fonts.googleapis.com/css2?family=Roboto:wght@400&display=swap' },
      { name: 'Futura', css: 'Futura, "Trebuchet MS", sans-serif', cdn: null },
      { name: 'Garamond', css: '"EB Garamond", Garamond, serif', cdn: 'https://fonts.googleapis.com/css2?family=EB+Garamond:wght@400&display=swap' },
      { name: 'Montserrat', css: '"Montserrat", sans-serif', cdn: 'https://fonts.googleapis.com/css2?family=Montserrat:wght@400&display=swap' },
      { name: 'Open Sans', css: '"Open Sans", sans-serif', cdn: 'https://fonts.googleapis.com/css2?family=Open+Sans:wght@400&display=swap' },
      { name: 'Proxima Nova', css: '"Proxima Nova", "Helvetica Neue", sans-serif', cdn: null },
      { name: 'Calibri', css: 'Calibri, sans-serif', cdn: null },
      { name: 'Georgia', css: 'Georgia, serif', cdn: null },
      { name: 'Avenir', css: 'Avenir, "Century Gothic", sans-serif', cdn: null },
      { name: 'Inter', css: '"Inter", sans-serif', cdn: 'https://fonts.googleapis.com/css2?family=Inter:wght@400&display=swap' },
      { name: 'Lato', css: '"Lato", sans-serif', cdn: 'https://fonts.googleapis.com/css2?family=Lato:wght@400&display=swap' },
      { name: 'Baskerville', css: '"Libre Baskerville", Baskerville, serif', cdn: 'https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@400&display=swap' },
      { name: 'Source Sans Pro', css: '"Source Sans 3", sans-serif', cdn: 'https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@400&display=swap' },
      { name: 'Nunito', css: '"Nunito", sans-serif', cdn: 'https://fonts.googleapis.com/css2?family=Nunito:wght@400&display=swap' },
      { name: 'SF Pro', css: '"SF Pro Display", -apple-system, BlinkMacSystemFont, sans-serif', cdn: null },
      { name: 'Poppins', css: '"Poppins", sans-serif', cdn: 'https://fonts.googleapis.com/css2?family=Poppins:wght@400&display=swap' },
      { name: 'Century Gothic', css: '"Century Gothic", "Apple Gothic", sans-serif', cdn: null }
    ];

    const ROUNDS = 10;
    const SAMPLE_TEXT = "The quick brown fox jumps over the lazy dog";

    function IconTrophy() {
      // simple trophy emoji / accessible fallback
      return (<span aria-hidden="true" style={{fontSize: '1.6rem'}}>üèÜ</span>);
    }
    function IconShare() {
      return (<span aria-hidden="true" style={{fontSize: '1rem'}}>üîó</span>);
    }
    function IconRefresh() {
      return (<span aria-hidden="true" style={{fontSize: '1rem'}}>üîÑ</span>);
    }

    function FontGame() {
      const [currentRound, setCurrentRound] = useState(0);
      const [score, setScore] = useState(0);
      const [gameState, setGameState] = useState('playing');
      const [currentFont, setCurrentFont] = useState(null);
      const [options, setOptions] = useState([]);
      const [selectedAnswer, setSelectedAnswer] = useState(null);
      const [feedback, setFeedback] = useState('');
      const [usedFonts, setUsedFonts] = useState([]);
      const [fontsLoaded, setFontsLoaded] = useState(false);

      useEffect(() => {
        // Load fonts that need CDN (some are already in head, but this ensures uniqueness)
        const fontLinks = fonts.filter(f => f.cdn).map(f => f.cdn);
        const uniqueLinks = [...new Set(fontLinks)];
        uniqueLinks.forEach(link => {
          const existingLink = document.querySelector(`link[href="${link}"]`);
          if (!existingLink) {
            const linkElement = document.createElement('link');
            linkElement.href = link;
            linkElement.rel = 'stylesheet';
            document.head.appendChild(linkElement);
          }
        });

        // Give fonts time to load
        const t = setTimeout(() => setFontsLoaded(true), 500);
        return () => clearTimeout(t);
      }, []);

      useEffect(() => {
        if (gameState === 'playing' && fontsLoaded) {
          setupRound();
        }
        // eslint-disable-next-line react-hooks/exhaustive-deps
      }, [currentRound, gameState, fontsLoaded]);

      const setupRound = () => {
        const availableFonts = fonts.filter(f => !usedFonts.includes(f.name));
        // if we ran out (rare), reset usedFonts
        const pool = availableFonts.length ? availableFonts : fonts;
        const correctFont = pool[Math.floor(Math.random() * pool.length)];

        const wrongFonts = fonts
          .filter(f => f.name !== correctFont.name)
          .sort(() => Math.random() - 0.5)
          .slice(0, 3);

        const allOptions = [correctFont, ...wrongFonts].sort(() => Math.random() - 0.5);

        setCurrentFont(correctFont);
        setOptions(allOptions);
        setSelectedAnswer(null);
        setFeedback('');
        setUsedFonts(prev => {
          const next = [...prev, correctFont.name];
          // keep it bounded
          if (next.length > fonts.length) return next.slice(-fonts.length);
          return next;
        });
      };

      const handleAnswer = (selectedFont) => {
        setSelectedAnswer(selectedFont.name);

        if (selectedFont.name === currentFont.name) {
          setScore(s => s + 1);
          setFeedback('‚úì Correct!');
        } else {
          setFeedback(`‚úó Wrong! It was ${currentFont.name}`);
        }

        setTimeout(() => {
          if (currentRound + 1 < ROUNDS) {
            setCurrentRound(r => r + 1);
          } else {
            setGameState('finished');
          }
        }, 1200);
      };

      const restartGame = () => {
        setCurrentRound(0);
        setScore(0);
        setGameState('playing');
        setUsedFonts([]);
      };

      const shareScore = () => {
        const percentage = Math.round((score / ROUNDS) * 100);
        const text = `I scored ${score}/${ROUNDS} (${percentage}%) on the Font Identification Game! Can you beat my score?`;
        const url = window.location.href;
        const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`;

        if (navigator.share) {
          navigator.share({
            title: 'Font Identification Game',
            text,
            url
          }).catch(() => {
            window.open(twitterUrl, '_blank', 'width=550,height=420');
          });
        } else {
          window.open(twitterUrl, '_blank', 'width=550,height=420');
        }
      };

      if (!fontsLoaded) {
        return (
          <div className="min-h-screen flex items-center justify-center">
            <div className="bg-white rounded-2xl shadow-2xl p-8 text-center">
              <div className="animate-spin rounded-full h-16 w-16 border-b-4 border-purple-600 mx-auto mb-4"></div>
              <p className="text-gray-600 font-semibold">Loading fonts...</p>
            </div>
          </div>
        );
      }

      if (gameState === 'finished') {
        const percentage = Math.round((score / ROUNDS) * 100);
        return (
          <div className="min-h-screen bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center p-4">
            <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full text-center">
              <div className="w-20 h-20 mx-auto mb-4 text-yellow-500 flex items-center justify-center">
                <IconTrophy />
              </div>
              <h1 className="text-3xl font-bold mb-4 text-gray-800">Game Over!</h1>
              <div className="mb-6">
                <p className="text-6xl font-bold text-purple-600 mb-2">{score}/{ROUNDS}</p>
                <p className="text-xl text-gray-600">{percentage}% Correct</p>
                <p className="text-lg text-gray-500 mt-2">
                  {percentage === 100 ? 'üéâ Perfect Score!' :
                   percentage >= 80 ? 'üåü Excellent!' :
                   percentage >= 60 ? 'üëç Good Job!' :
                   percentage >= 40 ? 'üìö Keep Practicing!' :
                   'üí™ Try Again!'}
                </p>
              </div>
              <div className="space-y-3">
                <button
                  onClick={shareScore}
                  className="w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg flex items-center justify-center gap-2 transition"
                >
                  <IconShare /> Share on Twitter
                </button>
                <button
                  onClick={restartGame}
                  className="w-full bg-purple-500 hover:bg-purple-600 text-white font-semibold py-3 px-6 rounded-lg flex items-center justify-center gap-2 transition"
                >
                  <IconRefresh /> Play Again
                </button>
              </div>
            </div>
          </div>
        );
      }

      return (
        <div className="min-h-screen bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center p-4">
          <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-2xl w-full">
            <div className="flex justify-between items-center mb-6">
              <div className="text-sm font-semibold text-gray-600">
                Round {currentRound + 1}/{ROUNDS}
              </div>
              <div className="text-sm font-semibold text-gray-600">
                Score: {score}/{currentRound}
              </div>
            </div>

            <h2 className="text-2xl font-bold mb-6 text-center text-gray-800">
              What font is this?
            </h2>

            {currentFont && (
              <div className="mb-8 p-6 bg-gray-50 rounded-xl border-2 border-gray-200">
                <p
                  style={{ fontFamily: currentFont.css }}
                  className="text-4xl text-center text-gray-800 leading-relaxed"
                >
                  {SAMPLE_TEXT}
                </p>
              </div>
            )}

            {feedback && (
              <div className={`mb-4 p-3 rounded-lg text-center font-semibold ${
                feedback.includes('‚úì') ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'
              }`}>
                {feedback}
              </div>
            )}

            <div className="grid grid-cols-2 gap-4">
              {options.map((font) => (
                <button
                  key={font.name}
                  onClick={() => handleAnswer(font)}
                  disabled={selectedAnswer !== null}
                  className={`p-4 rounded-lg font-semibold text-lg transition ${
                    selectedAnswer === null
                      ? 'bg-purple-500 hover:bg-purple-600 text-white'
                      : selectedAnswer === font.name
                      ? font.name === currentFont.name
                        ? 'bg-green-500 text-white'
                        : 'bg-red-500 text-white'
                      : font.name === currentFont.name
                      ? 'bg-green-500 text-white'
                      : 'bg-gray-300 text-gray-500'
                  } disabled:cursor-not-allowed`}
                >
                  {font.name}
                </button>
              ))}
            </div>
          </div>
        </div>
      );
    }

    // Render
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<FontGame />);
  </script>
</body>
</html>
